<article class="container" aria-labelledby="profile-heading" id="profile-section">
  @if (isLoading) {
    <div class="profile-skeleton">
      <app-skeleton-loader type="avatar" />
      <app-skeleton-loader type="text" [width]="'150px'" [height]="'2rem'" />
      <app-skeleton-loader type="chip" [count]="4" />
    </div>
  } @else {
    <header class="profile-header">
      <img [src]="avatar" alt="Profile avatar" class="logo" />

      <nav class="burger-menu" [class.active]="menuOpen" aria-label="Profile options">
        <button
          class="burger-button"
          [class.active]="menuOpen"
          (click)="toggleMenu()"
          aria-label="Open profile menu"
          [attr.aria-expanded]="menuOpen"
          aria-haspopup="true"
        >
          @if (isAuthenticated && currentUser) {
            <img
              [src]="currentUser.photoURL"
              [alt]="currentUser.displayName || 'User avatar'"
              class="user-avatar"
            />
          } @else {
            <i class="fas fa-ellipsis-v" aria-hidden="true"></i>
          }
        </button>

        <!-- Dropdown menu -->
        @if (menuOpen) {
          <div class="profile-dropdown" role="menu" aria-label="Profile settings">
            @if (isAuthenticated && currentUser) {
              <div class="user-info">
                <div class="user-details">
                  <div class="user-name">{{ currentUser.displayName }}</div>
                  <div class="user-email">{{ currentUser.email }}</div>
                </div>
              </div>

              <div class="dropdown-separator" role="separator"></div>
            }

            <button class="dropdown-item theme-toggle" role="menuitem" (click)="cycleTheme()">
              <i
                class="fas"
                [class.fa-moon]="currentTheme === 'dark'"
                [class.fa-sun]="currentTheme === 'white'"
                [class.fa-gem]="currentTheme === 'glass'"
                aria-hidden="true"
              ></i>
              <span>{{ themeDisplayName }}</span>
            </button>

            <div class="dropdown-separator" role="separator"></div>

            <button class="dropdown-item video-bg-toggle" role="menuitem" (click)="toggleVideoBg()">
              <i
                class="fas"
                [class.fa-circle]="currentBackground === 'black'"
                [class.fa-circle-notch]="currentBackground === 'white'"
                [class.fa-play]="currentBackground === 'video'"
                aria-hidden="true"
              ></i>
              <span>{{ backgroundDisplayName }}</span>
            </button>

            <div class="dropdown-separator" role="separator"></div>

            <button
              class="dropdown-item font-size-toggle"
              role="menuitem"
              (click)="changeFontSize()"
            >
              <i class="fas fa-text-height" aria-hidden="true"></i>
              <span>Font Size: {{ fontSizeDisplayName }}</span>
            </button>

            @if (isAuthenticated) {
              <div class="dropdown-separator" role="separator"></div>

              <button
                class="dropdown-item sign-out btn btn-danger"
                role="menuitem"
                (click)="signOut()"
                ngbTooltip="Sign out of your account"
                placement="left"
                container="body"
              >
                <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
                <span>Sign Out</span>
              </button>
            }
          </div>
        }
      </nav>
    </header>

    <h1 id="profile-heading">✨ 3dime ✨</h1>
    <nav class="socials" aria-label="Social media links">
      @for (link of socialLinks; track link.provider) {
        <a
          [href]="link.url"
          target="_blank"
          rel="noopener noreferrer"
          [attr.aria-label]="link.provider + ' profile'"
        >
          <i [class]="getFontAwesomeLinks(link.provider)" aria-hidden="true"></i>
        </a>
      } @empty {
        <p>No social links available.</p>
      }
    </nav>
  }
</article>
