<article class="container" aria-labelledby="profile-heading" id="profile-section">
  @if (isLoading) {
    <div class="loading-container">
      <div class="spinner">
        <div class="spinner-circle"></div>
      </div>
      <p>Loading profile...</p>
    </div>
  } @else {
    <header class="profile-header">
      <img [src]="avatar" alt="Profile avatar" class="logo" />

      <nav class="burger-menu" aria-label="Profile options">
        <button
          mat-icon-button
          class="burger-button"
          [matMenuTriggerFor]="profileMenu"
          aria-label="Open profile menu"
          aria-haspopup="true"
        >
          @if (isAuthenticated && currentUser) {
            <img
              [src]="currentUser.photoURL"
              [alt]="currentUser.displayName || 'User avatar'"
              class="user-avatar"
            />
          } @else {
            <mat-icon>more_vert</mat-icon>
          }
        </button>

        <!-- Material Menu -->
        <mat-menu #profileMenu="matMenu" class="profile-menu">
          @if (isAuthenticated && currentUser) {
            <div class="user-info" mat-menu-item disabled>
              <div class="user-details">
                <div class="user-name">{{ currentUser.displayName }}</div>
                <div class="user-email">{{ currentUser.email }}</div>
              </div>
            </div>
            <mat-divider></mat-divider>
          }

          <button mat-menu-item (click)="cycleTheme()">
            <mat-icon>
              @if (currentTheme === 'dark') {
                dark_mode
              } @else if (currentTheme === 'white') {
                light_mode
              } @else {
                auto_awesome
              }
            </mat-icon>
            <span>{{ themeDisplayName }}</span>
          </button>

          <mat-divider></mat-divider>

          <button mat-menu-item (click)="toggleVideoBg()">
            <mat-icon>
              @if (currentBackground === 'video') {
                play_circle
              } @else {
                stop_circle
              }
            </mat-icon>
            <span>{{ backgroundDisplayName }}</span>
          </button>

          <mat-divider></mat-divider>

          <button mat-menu-item (click)="changeFontSize()">
            <mat-icon>text_fields</mat-icon>
            <span>Font Size: {{ fontSizeDisplayName }}</span>
          </button>

          @if (isAuthenticated) {
            <mat-divider></mat-divider>
            <button mat-menu-item (click)="signOut()">
              <mat-icon>logout</mat-icon>
              <span>Sign Out</span>
            </button>
          }
        </mat-menu>
      </nav>
    </header>

    <h2 id="profile-heading">✨ {{ name }} ✨</h2>
    <nav class="socials" aria-label="Social media links">
      @for (link of socialLinks; track link.provider) {
        <a
          [href]="link.url"
          target="_blank"
          rel="noopener noreferrer"
          [attr.aria-label]="link.provider + ' profile'"
        >
          <i [class]="getFontAwesomeLinks(link.provider)" aria-hidden="true"></i>
        </a>
      } @empty {
        <p>No social links available.</p>
      }
    </nav>
  }
</article>
