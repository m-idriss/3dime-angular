<!-- Toast Container for Global Messages -->
<div
  class="toast-container position-fixed top-0 start-50 translate-middle-x p-3"
  style="z-index: 12000;"
>
  <!-- Success Toast -->
  @if (toastService.successMessage()) {
    <ngb-toast
      [autohide]="true"
      [delay]="5000"
      (hidden)="toastService.clearSuccess()"
      class="bg-success text-white"
    >
      {{ toastService.successMessage() }}
    </ngb-toast>
  }

  <!-- Error Toast -->
  @if (toastService.errorMessage()) {
    <ngb-toast
      [autohide]="true"
      [delay]="5000"
      (hidden)="toastService.clearError()"
      class="bg-danger text-white"
    >
      {{ toastService.errorMessage() }}
    </ngb-toast>
  }
</div>

<main class="home-page" aria-label="Main content" id="main-content" role="main">
  <div class="home-container">
    <article class="hero-section" itemscope itemtype="https://schema.org/WebApplication">
      <h1 class="hero-title" itemprop="name">
        <span class="hero-icon" aria-hidden="true">ðŸ“…</span>
        Your Automated Calendar Converter
      </h1>
      <p class="hero-description" itemprop="description">
        Upload images of your appointments, and AI turns them into calendar-ready events.<br>
        No registration â€“ simple Google login, 100% free.
      </p>

      <!-- Key Features for SEO -->
      <div class="hero-features" style="display: none;" itemprop="featureList">
        <ul>
          <li>Convert images (JPG, PNG) and PDF files to calendar events</li>
          <li>AI-powered event extraction with GPT-4 Vision</li>
          <li>Batch processing - upload multiple files at once</li>
          <li>Edit events before downloading</li>
          <li>Export to ICS format (Google Calendar, Outlook, Apple Calendar compatible)</li>
          <li>Free unlimited conversions - no signup required</li>
          <li>Secure and privacy-focused processing</li>
        </ul>
      </div>
    </article>

    <!-- Desktop: Side-by-side layout when events exist, centered when no events -->
    <div class="content-layout" [class.has-calendar]="calendarStateService.isVisible() && isDesktop()">
      <div class="converter-card">
        <app-converter></app-converter>
      </div>

      <!-- Desktop inline calendar view (only when visible and desktop) -->
      @if (calendarStateService.isVisible() && isDesktop()) {
        <div class="calendar-card">
          <app-calendar-view
            [events]="calendarStateService.events()"
            [visible]="calendarStateService.isVisible()"
            [inline]="true"
            (visibleChange)="handleCalendarVisibilityChange($event)"
            (eventsChange)="handleCalendarEventsChange($event)"
            (exportIcs)="handleCalendarExport()"
          />
        </div>
      }
    </div>
  </div>
</main>

<!-- Single calendar instance with responsive inline mode -->
@if (calendarStateService.isVisible() && !isDesktop()) {
  <app-calendar-view
    [events]="calendarStateService.events()"
    [visible]="calendarStateService.isVisible()"
    [inline]="false"
    (visibleChange)="handleCalendarVisibilityChange($event)"
    (eventsChange)="handleCalendarEventsChange($event)"
    (exportIcs)="handleCalendarExport()"
  />
}
