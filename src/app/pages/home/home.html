<!-- Toast Container for Global Messages -->
<div
  class="toast-container position-fixed top-0 start-50 translate-middle-x p-3"
  style="z-index: 12000;"
>
  <!-- Success Toast -->
  @if (toastService.successMessage()) {
    <ngb-toast
      [autohide]="true"
      [delay]="5000"
      (hidden)="toastService.clearSuccess()"
      class="bg-success text-white"
    >
      {{ toastService.successMessage() }}
    </ngb-toast>
  }

  <!-- Error Toast -->
  @if (toastService.errorMessage()) {
    <ngb-toast
      [autohide]="true"
      [delay]="5000"
      (hidden)="toastService.clearError()"
      class="bg-danger text-white"
    >
      {{ toastService.errorMessage() }}
    </ngb-toast>
  }
</div>

<main class="home-page" aria-label="Main content">
  <div class="home-container">
    <div class="hero-section">
      <h1 class="hero-title">
        <span class="hero-icon">ðŸ“…</span>
        Calendar Converter App
      </h1>
      <p class="hero-description">
        Upload or snap your appointments, and AI turns them into calendar-ready events.
      </p>
    </div>

    <!-- Desktop: Side-by-side layout when events exist, centered when no events -->
    <div class="content-layout" [class.has-calendar]="calendarStateService.isVisible() && isDesktop()">
      <div class="converter-card">
        <app-converter></app-converter>
      </div>

      <!-- Desktop inline calendar view (only when visible and desktop) -->
      @if (calendarStateService.isVisible() && isDesktop()) {
        <div class="calendar-card">
          <app-calendar-view
            [events]="calendarStateService.events()"
            [visible]="calendarStateService.isVisible()"
            [inline]="true"
            (visibleChange)="handleCalendarVisibilityChange($event)"
            (eventsChange)="handleCalendarEventsChange($event)"
            (exportIcs)="handleCalendarExport()"
          />
        </div>
      }
    </div>
  </div>
</main>

<!-- Single calendar instance with responsive inline mode -->
@if (calendarStateService.isVisible() && !isDesktop()) {
  <app-calendar-view
    [events]="calendarStateService.events()"
    [visible]="calendarStateService.isVisible()"
    [inline]="false"
    (visibleChange)="handleCalendarVisibilityChange($event)"
    (eventsChange)="handleCalendarEventsChange($event)"
    (exportIcs)="handleCalendarExport()"
  />
}
